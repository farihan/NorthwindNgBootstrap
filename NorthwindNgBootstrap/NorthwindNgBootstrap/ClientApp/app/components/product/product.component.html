<header class="py-4 bg-white">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <h1><i class="fa fa-product-hunt"></i> Product</h1>
            </div>
        </div>
    </div>
</header>

<section id="actions" class="py-4 mb-2 bg-faded">
    <div class="container">
        <div class="row">
            <div class="col-md-6 offset-md-6 ">
                <div class="input-group">
                    <input id="filter" type="text" [(ngModel)]="query.filter" name="filter" class="form-control" placeholder="Search product goods...">
                    <span class="input-group-btn">
                        <button class="btn btn-secondary" (click)="onFilterChange()">Search</button>
                    </span>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="container">
    <div class="row">
        <div class="col">
            <p>This component demonstrates fetching products from the server.</p>

            <p *ngIf="!queryResult"><em>Loading...</em></p>

            <div class="my-2 span12 pull-right">
                <a href="#" class="btn btn-outline-secondary btn-sm">Create Product</a>
            </div>

            <table class='table'>
                <thead class="thead-default">
                    <tr>
                        <th *ngFor="let column of columns">
                            <a [routerLink]="['/product']" *ngIf="column.isSortable" (click)="sortBy(column.key)">
                                {{ column.title }}
                            </a><i *ngIf="query.sortBy === column.key"
                                   class="fa"
                                   [class.fa-sort-asc]="query.isSortAscending"
                                   [class.fa-sort-desc]="!query.isSortAscending"></i>
                            <div *ngIf="!column.isSortable">
                                {{ column.title }}
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let record of queryResult.records">
                        <td>{{ record.productId }}</td>
                        <td>{{ record.productName }}</td>
                        <td>{{ record.quantityPerUnit }}</td>
                        <td>{{ record.unitPrice }}</td>
                        <td>{{ record.unitsInStock }}</td>
                        <td>{{ record.unitsOnOrder }}</td>
                        <td>{{ record.reorderLevel }}</td>
                        <td><input type="checkbox" [ngModel]="record.discontinued" onclick="return false;" /></td>
                        <td style="width:250px">
                            <button class="btn btn-outline-secondary btn-sm" role="button" (click)="openProductDetails(modalProductDetails, record.productId)">Details</button>
                            <button class="btn btn-outline-secondary btn-sm" role="button" (click)="openProductUpdate(modalProductUpdate, record.productId)">Update</button>
                            <a href="#" class="btn btn-outline-secondary btn-sm" role="button">Delete</a>
                        </td>
                    </tr>
                </tbody>
            </table>

            <pagination [total-records]="queryResult.totalRecords" [page-size]="query.pageSize" (page-changed)="onPageChange($event)"></pagination>
        </div>
    </div>
</div>

<ng-template id="modalProductDetails" #modalProductDetails let-c="close" let-d="dismiss" class="small">
    <div class="modal-header">
        <h4 class="modal-title"><i class="fa fa-file"></i> Product Details</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Product Name</label>
            <div class="col-sm-8">
                <input type="text" id="productName" name="productName" placeholder="" class="form-control" [(ngModel)]="productDetails.productName" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Quantity Per Unit</label>
            <div class="col-sm-8 input-group">
                <input type="text" id="quantityPerUnit" name="quantityPerUnit" placeholder="" class="form-control small" [(ngModel)]="productDetails.quantityPerUnit" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Unit Price</label>
            <div class="col-sm-8 input-group">
                <input type="text" id="unitPrice" name="unitPrice" placeholder="" class="form-control input-sm" [(ngModel)]="productDetails.unitPrice" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Units In Stock</label>
            <div class="col-sm-8 input-group">
                <input type="text" id="unitsInStock" name="unitsInStock" placeholder="" class="form-control input-sm" [(ngModel)]="productDetails.unitsInStock" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Units On Order</label>
            <div class="col-sm-8 input-group">
                <input type="text" id="unitsOnOrder" name="unitsOnOrder" placeholder="" class="form-control input-sm" [(ngModel)]="productDetails.unitsOnOrder" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Reorder Level</label>
            <div class="col-sm-8 input-group">
                <input type="text" id="reorderLevel" name="reorderLevel" placeholder="" class="form-control input-sm" [(ngModel)]="productDetails.reorderLevel" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Discontinued</label>
            <div class="col-sm-8 input-group">
                <input type="checkbox" onclick="return false;" style="margin-top:15px" [ngModel]="productDetails.discontinued" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Supplier</label>
            <div class="col-sm-8 input-group">
                <select id="supplierId" class="form-control" name="supplierId" [(ngModel)]="productDetails.supplierId">
                    <option value="">Select...</option>
                    <option *ngFor="let supplier of suppliers" value="{{ supplier.supplierID }}">{{ supplier.contactName }}&nbsp;({{ supplier.companyName }})</option>
                </select>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Category</label>
            <div class="col-sm-8">
                <select id="categoryId" class="form-control" name="categoryId" [(ngModel)]="productDetails.categoryId">
                    <option value="">Select...</option>
                    <option *ngFor="let category of categories" value="{{ category.categoryID }}">{{ category.categoryName }}</option>
                </select>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-outline-dark" (click)="c('Close click')">Cancel</button>
    </div>
</ng-template>

<ng-template id="modalProductUpdate" #modalProductUpdate let-c="close" let-d="dismiss" class="small">
    <div class="modal-header">
        <h4 class="modal-title"><i class="fa fa-file"></i> Product Details</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Product Name</label>
            <div class="col-sm-8">
                <input type="text" id="productName" name="productName" placeholder="" class="form-control" [(ngModel)]="productUpdate.productName" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Quantity Per Unit</label>
            <div class="col-sm-8 input-group">
                <input type="text" id="quantityPerUnit" name="quantityPerUnit" placeholder="" class="form-control small" [(ngModel)]="productUpdate.quantityPerUnit" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Unit Price</label>
            <div class="col-sm-8 input-group">
                <input type="text" id="unitPrice" name="unitPrice" placeholder="" class="form-control input-sm" [(ngModel)]="productUpdate.unitPrice" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Units In Stock</label>
            <div class="col-sm-8 input-group">
                <input type="text" id="unitsInStock" name="unitsInStock" placeholder="" class="form-control input-sm" [(ngModel)]="productUpdate.unitsInStock" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Units On Order</label>
            <div class="col-sm-8 input-group">
                <input type="text" id="unitsOnOrder" name="unitsOnOrder" placeholder="" class="form-control input-sm" [(ngModel)]="productUpdate.unitsOnOrder" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Reorder Level</label>
            <div class="col-sm-8 input-group">
                <input type="text" id="reorderLevel" name="reorderLevel" placeholder="" class="form-control input-sm" [(ngModel)]="productUpdate.reorderLevel" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Discontinued</label>
            <div class="col-sm-8 input-group">
                <input type="checkbox" onclick="return false;" style="margin-top:15px" [ngModel]="productUpdate.discontinued" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Supplier</label>
            <div class="col-sm-8 input-group">
                <select id="supplierId" class="form-control" name="supplierId" [(ngModel)]="productUpdate.supplierId">
                    <option value="">Select...</option>
                    <option *ngFor="let supplier of suppliers" value="{{ supplier.supplierID }}">{{ supplier.contactName }}&nbsp;({{ supplier.companyName }})</option>
                </select>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword" class="col-sm-4 col-form-label">Category</label>
            <div class="col-sm-8">
                <select id="categoryId" class="form-control" name="categoryId" [(ngModel)]="productUpdate.categoryId">
                    <option value="">Select...</option>
                    <option *ngFor="let category of categories" value="{{ category.categoryID }}">{{ category.categoryName }}</option>
                </select>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-outline-dark" (click)="c('Close click')">Cancel</button>
        <button type="button" class="btn btn-sm btn-primary" (click)="c('Close click')">Update</button>
    </div>
</ng-template>